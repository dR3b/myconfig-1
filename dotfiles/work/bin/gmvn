#!/usr/bin/env nix-shell
#! nix-shell -i bash -p maven

# is a substitute for `mvn`, but creates a local repository for each git project
# if there is no git repo, it falls back to repo in current folder

repo="$(git rev-parse --show-toplevel)/.m2/repository"
RESULT=$?
set -e
if [[ $RESULT -eq 0 ]]; then
  repo="$(pwd)/.m2/repository"
fi

echo "repo is: $repo"
exec mvn \
  -Dmaven.repo.local="$repo" \
  "$@"
